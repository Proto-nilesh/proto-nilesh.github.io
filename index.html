<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI Quiz</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        #results {
            display: none;
        }
        .bar {
            width: 100%;
            height: 20px;
            background: #ddd;
            margin: 10px 0;
            position: relative;
        }
        .bar-fill {
            height: 100%;
            background: #4CAF50;
        }
        .label {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            top: -20px;
        }
        .left, .right {
            position: absolute;
            top: 25px;
        }
        .left { left: 0; }
        .right { right: 0; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.4.0/lib/p5.js"></script>
</head>
<body>
    <h1>MBTI Quiz</h1>
    <form id="quizForm">
        <label for="goals">What are your main goals in life?</label><br>
        <textarea id="goals" name="goals" rows="3" cols="50"></textarea><br><br>
        
        <label for="age">Your age:</label><br>
        <input type="number" id="age" name="age" min="0" max="120"><br><br>
        
        <label for="city">Your city:</label><br>
        <input type="text" id="city" name="city"><br><br>

        <h2>MBTI Questions:</h2>
        <p>1. Do you prefer to spend time with others or by yourself?</p>
        <label><input type="radio" name="q1" value="E"> With others</label>
        <label><input type="radio" name="q1" value="I"> By myself</label><br>

        <p>2. When making a decision, do you mainly focus on logical reasoning or personal values?</p>
        <label><input type="radio" name="q2" value="T"> Logical reasoning</label>
        <label><input type="radio" name="q2" value="F"> Personal values</label><br>

        <p>3. Do you enjoy a structured and planned daily routine, or do you prefer to go with the flow?</p>
        <label><input type="radio" name="q3" value="J"> Structured and planned</label>
        <label><input type="radio" name="q3" value="P"> Go with the flow</label><br>

        <p>4. Are you more interested in the practical reality or in possibilities and ideas?</p>
        <label><input type="radio" name="q4" value="S"> Practical reality</label>
        <label><input type="radio" name="q4" value="N"> Possibilities and ideas</label><br>

        <p>5. Do you tend to be more talkative or more reserved in social situations?</p>
        <label><input type="radio" name="q5" value="E"> Talkative</label>
        <label><input type="radio" name="q5" value="I"> Reserved</label><br>

        <p>6. When you make plans, do you prefer to stick to them or change them as new situations arise?</p>
        <label><input type="radio" name="q6" value="J"> Stick to them</label>
        <label><input type="radio" name="q6" value="P"> Change them</label><br>

        <p>7. In your work, do you enjoy dealing with facts and details or concepts and theories?</p>
        <label><input type="radio" name="q7" value="S"> Facts and details</label>
        <label><input type="radio" name="q7" value="N"> Concepts and theories</label><br>

        <p>8. When solving problems, do you mostly use your head or your heart?</p>
        <label><input type="radio" name="q8" value="T"> Head</label>
        <label><input type="radio" name="q8" value="F"> Heart</label><br>

        <button type="submit">Submit</button>
    </form>

    <div id="results">
        <h2>Your MBTI Type:</h2>
        <p id="mbtiType"></p>
        <div id="visualization"></div>
    </div>

    <script>
        function calculateMBTI(formData) {
            let mbti = {
                'I': 0, 'E': 0, 'S': 0, 'N': 0, 'T': 0, 'F': 0, 'J': 0, 'P': 0
            };

            const questions = ['q1', 'q2', 'q3', 'q4', 'q5', 'q6', 'q7', 'q8'];
            questions.forEach(q => {
                mbti[formData[q]]++;
            });

            let type = '';
            ['I', 'E'].forEach(t => type += mbti[t] > 1 ? t : '');
            ['S', 'N'].forEach(t => type += mbti[t] > 1 ? t : '');
            ['T', 'F'].forEach(t => type += mbti[t] > 1 ? t : '');
            ['J', 'P'].forEach(t => type += mbti[t] > 1 ? t : '');

            return {
                type: type,
                scores: {
                    E: mbti.E * 25,
                    I: mbti.I * 25,
                    S: mbti.S * 25,
                    N: mbti.N * 25,
                    T: mbti.T * 25,
                    F: mbti.F * 25,
                    J: mbti.J * 25,
                    P: mbti.P * 25
                }
            };
        }

        document.getElementById('quizForm').addEventListener('submit', function(event) {
            event.preventDefault();
            let formData = new FormData(this);
            let result = calculateMBTI(Object.fromEntries(formData.entries()));
            
            document.getElementById('mbtiType').innerText = result.type;
            document.getElementById('results').style.display = 'block';

            // Setup p5.js sketch for visualization
            let sketch = function(p) {
                p.setup = function() {
                    p.createCanvas(400, 300);
                    p.noLoop();
                };

                p.draw = function() {
                    p.background(220);
                    let y = 20;
                    let dimensions = ['E-I', 'S-N', 'T-F', 'J-P'];
                    let pairs = [['E', 'I'], ['S', 'N'], ['T', 'F'], ['J', 'P']];
                    
                    pairs.forEach((pair, index) => {
                        let scoreA = result.scores[pair[0]];
                        let scoreB = result.scores[pair[1]];
                        let total = scoreA + scoreB;
                        let percentage = total === 0 ? 50 : (scoreA / total) * 100;
                        
                        p.fill(200);
                        p.rect(50, y, 300, 20);
                        p.fill(50, 200, 50);
                        p.rect(50, y, percentage * 3, 20);
                        
                        p.fill(0);
                        p.text(dimensions[index], 200, y + 15);
                        
                        p.text(pair[0], 30, y + 15);
                        p.text(pair[1], 370, y + 15);
                        
                        y += 40;
                    });
                };
            };

            new p5(sketch, 'visualization');
        });
    </script>
</body>
</html>
